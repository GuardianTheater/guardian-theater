<div *ngIf="!needToSelectPlatform && !displayName && !activeCharacter && !(guardianService.noResults | async)" class="profile-spinner-wrapper">
  <div class="fi-widget spinner profile-spinner" title="Fetching Bungie Profile..."></div>
</div>
<div *ngIf="guardianService.noResults | async">Guardian {{ guardianService.searchName | async }} not found.</div>

<div *ngIf="needToSelectPlatform" class="columns small-12 button-group expanded">
  <button type="button" class="button xbox filter-toggle" (click)="selectPlatform(1)" title="Xbox"><span class="fi-social-xbox"></span></button>
  <button type="button" class="button playstation filter-toggle" (click)="selectPlatform(2)" title="PlayStation"><span class="fi-social-playstation"></span></button>
</div>

<div *ngIf="displayName && activeCharacter" class="profile small-12 columns" [ngStyle]="{'background-image': 'url(//www.bungie.net' + activeCharacter.backgroundPath + ')'}">
  <div class="row">
    <div class="active-character">
      <div class="emblem" [ngStyle]="{'background-image': 'url(//www.bungie.net' + activeCharacter.emblemPath + ')'}"></div>
      <div class="gamertag">
        {{ displayName }}
      </div>
      <div class="character-details" *ngIf="activeCharacter.characterBase"><span class="power-level">{{ activeCharacter.characterBase.powerLevel }} </span><span>// {{ activeCharacter.characterBase.classHash | destinyHash:'class' }} // {{ activeCharacter.characterBase.raceHash | destinyHash:'race' }}</span></div>
    </div>
  </div>
  <div class="row characters" *ngIf="characters">
    <div class="expand columns character" *ngFor="let character of characters" [ngStyle]="{'background-image': character.characterBase.characterId === activeCharacter.characterBase.characterId ? '' : 'url(//www.bungie.net' + character.backgroundPath + ')'}">
      <a (click)="selectCharacter(character.characterBase.characterId)"><span class="class-name">{{ character.characterBase.classHash | destinyHash:'class' }} </span><span class="power-level">{{ character.characterBase.powerLevel }}</span></a>
    </div>
  </div>
</div>

<div *ngIf="displayName && activeCharacter" class="row">
  <div class="columns small-12 mode-column">
    <label class="mode-selector-wrapper">
      <select class="mode-selector" [ngClass]="'mode-selected-' + gamemode" [ngModel]="gamemode" (change)="selectGamemode($event.target.value)">
        <option label="All" value="None" selected="selected">All</option>
        <option label="All PvE" value="AllPvE">All PvE</option>
        <option label="All PvP" value="AllPvP">All PvP</option>
        <option label="All Private Matches" value="PrivateMatchesAll">All Private Matches</option>
        <option label="Trials of Osiris" value="TrialsOfOsiris">Trials of Osiris</option>
        <option label="Iron Banner" value="IronBanner">Iron Banner</option>
        <option label="Raid" value="Raid">Raid</option>
        <option label="Prison of Elders" value="AllArena">Prison of Elders</option>
        <option label="Nightfall" value="Nightfall">Nightfall</option>
        <option label="Story" value="Story">Story</option>
        <option label="Strike" value="AllStrikes">Strike</option>
        <option label="Patrol" value="Patrol">Patrol</option>
        <option label="Control" value="Control">Control</option>
        <option label="Clash" value="Team">Clash</option>
        <option label="Supremacy" value="Supremacy">Supremacy</option>
        <option label="Rumble" value="FreeForAll">Rumble</option>
        <option label="Rift" value="Rift">Rift</option>
        <option label="Zone Control" value="ZoneControl">Zone Control</option>
        <option label="Mayhem" value="Mayhem">Mayhem</option>
        <option label="Skirmish" value="ThreeVsThree">Skirmish</option>
        <option label="Salvage" value="Lockdown">Salvage</option>
        <option label="Doubles" value="Doubles">Doubles</option>
        <option label="Elimination" value="Elimination">Elimination</option>
        <option label="Sparrow Racing League" value="Racing">Sparrow Racing League</option>
      </select>
    </label>
  </div>
</div>

<div class="row" *ngIf="displayName && activeCharacter">
  <div class="columns small-12 button-group expanded">
    <button type="button" class="button filter-toggle player" [ngClass]="{ 'hollow': !clipLimiter.self }" (click)="toggleLimiter('self')" [title]="displayName"><span class="fi-torso"></span></button>
    <button type="button" class="button filter-toggle fireteam" [ngClass]="{ 'hollow': !clipLimiter.fireteam }" (click)="toggleLimiter('fireteam')" title="Fireteam"><span class="fi-torsos"></span></button>
    <button type="button" class="button filter-toggle blueberry" [ngClass]="{ 'hollow': !clipLimiter.team }" (click)="toggleLimiter('team')" title="Blueberries"><span class="fi-torsos-all"></span></button>
    <button type="button" class="button filter-toggle enemy" [ngClass]="{ 'hollow': !clipLimiter.opponents }" (click)="toggleLimiter('opponents')" title="Opponents"><span class="fi-torsos-all"></span></button>
    <button *ngIf="membershipType === 1" type="button" class="button filter-toggle xbox" [ngClass]="{ 'hollow': !clipLimiter.xbox }" (click)="toggleLimiter('xbox')" title="Xbox"><span class="fi-social-xbox"></span></button>
    <button *ngIf="membershipType === 1" type="button" class="button filter-toggle twitch" [ngClass]="{ 'hollow': !clipLimiter.twitch }" (click)="toggleLimiter('twitch')" title="Twitch"><span class="fi-social-twitch"></span></button>
  </div>
</div>
  
<div class="row">
  <div *ngIf="displayName && activeCharacter" class="columns small-12 button-group expanded">
    <button type="button" class="button paging" (click)="prevPage()" [ngClass]="{'disabled': page < 1}" title="Previous"><span class="fi-previous"></span></button>
    <button type="button" class="button paging" (click)="nextPage()" title="Next"><span class="fi-next"></span></button>
  </div>
</div>

<div *ngIf="displayName && activeCharacter && (!activities || !activities.length) &&  !(guardianService.noActivities | async)" class="profile-spinner-wrapper"><div class="fi-widget spinner profile-spinner" title="Fetching Bungie Activities..."></div></div>
<div *ngIf="guardianService.noActivities | async">No activities found.</div>

<app-activity *ngFor="let activity of activities" [activity]="activity"></app-activity>

<div class="row" *ngIf="activities && activities.length">
  <div *ngIf="displayName && activeCharacter" class="columns small-12 button-group expanded">
    <button type="button" class="button paging" (click)="prevPage()" [ngClass]="{'disabled': page < 1}" title="Previous"><span class="fi-previous"></span></button>
    <button type="button" class="button paging" (click)="nextPage()" title="Next"><span class="fi-next"></span></button>
  </div>
</div>